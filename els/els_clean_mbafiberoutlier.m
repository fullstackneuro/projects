%manually cleaning fiber group outliers for individual subjects
%{
subjectlist 'els013','els014','els016','els017', ...
            'els024','els025','els026','els028','els032''els033','els039', ...
            'els041','els042','els045','els046','els047','els048', ...
            'els049','els050','els053','els054','els055','els056','els057', ...
            'els064','els065','els067','els068','els069','els070', ...
            'els072','els073','els074','els076','els077','els079','els081', ...
            'els083','els085','els087','els088','els093', ...
            'els006','els009','els012','els034','els040','els058','els059', ...
            'els060','els061','els062','els075','els086','els089','els090', ...
            'els092','els095','els097','els099','els100'};
%}

% cd to subject folder
cd('/media/storg/matproc/els058/dti60trilin/fibers/mrtrix');

%manually load fiber group, clean outliers, save cleaned fiber group
rh_fg_name = mrvSelectFile('r',{'*.pdb';'*.*'}, 'Select fiber group file');
rh_fg_unclean = fgRead(rh_fg_name);
[rh_fg_clean, fg_keep_vec] = mbaComputeFibersOutliers(rh_fg_unclean, 3, 2, 100);
fgWrite(rh_fg_clean, 'clean_rh_antshortins_nacc','mat');

%left hemisphere
lh_fg_name = mrvSelectFile('r',{'*.pdb';'*.*'}, 'Select fiber group file');
lh_fg_unclean = fgRead(lh_fg_name);
[lh_fg_clean, fg_keep_vec] = mbaComputeFibersOutliers(lh_fg_unclean, 2.5, 2, 100);
fgWrite(lh_fg_clean, 'clean_lh_antshortins_nacc','mat');